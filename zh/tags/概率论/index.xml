<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>概率论 on 绯想天</title><link>https://blog.fei.ac/zh/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/</link><description>Recent content in 概率论 on 绯想天</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Copyright © 2020 - 2023 Fei Pan</copyright><lastBuildDate>Sun, 17 Jul 2022 20:16:44 +0800</lastBuildDate><atom:link href="https://blog.fei.ac/zh/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/index.xml" rel="self" type="application/rss+xml"/><item><title>从概率生成函数出发研究离散概率</title><link>https://blog.fei.ac/zh/posts/pgf-discrete-possibility/</link><pubDate>Sun, 17 Jul 2022 20:16:44 +0800</pubDate><guid>https://blog.fei.ac/zh/posts/pgf-discrete-possibility/</guid><description>&lt;p>概率生成函数是一种特殊的生成函数，其导数和卷积在离散概率的研究中都有意义。&lt;/p>
&lt;h2 id="一些基础概念">一些基础概念&lt;/h2>
&lt;p>对于一个仅取非负实数值的随机变量 $X$，我们定义其概率生成函数为&lt;/p>
&lt;p>$$
G_X(z) = \sum_{k\ge 0} P(X=k)z^k
$$&lt;/p>
&lt;p>与一般的幂级数形式的生成函数不同，概率生成函数存在非整数次的项。&lt;/p>
&lt;h2 id="导数期望与方差">导数、期望与方差&lt;/h2>
&lt;p>我们很少研究生成函数的导数，但概率生成函数的导数却值得研究：它与随机变量的期望和方差关系匪浅。由于&lt;/p>
&lt;p>$$
G_X^\prime(z) = \sum_{k\ge 0} kP(X=k)z^{k-1}
$$&lt;/p>
&lt;p>我们可以得到&lt;/p>
&lt;p>$$
E(X) = \sum_{k\ge 0} kP(X=k) = G_X^\prime(1)
$$&lt;/p>
&lt;p>同理我们也可以用 $G_X(z)$ 表示 $X$ 的方差 $V(X)$：&lt;/p>
&lt;p>$$
\begin{aligned}
V(X) &amp;amp;= E(X^2) - E^2(X) \newline
&amp;amp;= E(X^2) - \left(G_X^\prime(1)\right)^2 \newline
&amp;amp;= G_X^{\prime\prime}(1) + G_X^\prime(1) - \left(G_X^\prime(1)\right)^2
\end{aligned}
$$&lt;/p>
&lt;p>其中&lt;/p>
&lt;p>$$
\begin{aligned}
E(X^2) &amp;amp;= \sum_{k\ge 0} k^2P(X=k) \newline
&amp;amp;= \sum_{k\ge 0}k(k-1)P(X=k) + \sum_{k\ge 0}kP(X=k) \newline
&amp;amp;= G_X^{\prime\prime}(1) + G_X^\prime(1)
\end{aligned}
$$&lt;/p>
&lt;p>总而言之，我们有&lt;/p>
&lt;p>$$
\begin{aligned}
E(X) &amp;amp;= G_X^\prime(1) \newline
V(X) &amp;amp;= G_X^{\prime\prime}(1) + G_X^\prime(1) - \left(G_X^\prime(1)\right)^2
\end{aligned}
$$&lt;/p>
&lt;p>利用这个关系，我们可以方便地求出一些随机变量的期望、方差。以 $n$ 阶均匀分布为例 (即 $X$ 以 $\frac 1 n$ 的概率取遍 $[0,n-1]$ 范围内的每一个整数)：&lt;/p>
&lt;p>$X$ 的概率生成函数为&lt;/p>
&lt;p>$$
G_n(z) = \frac{1}{n}\sum_{k=0}^{n-1}z^k = \frac{1-z^n}{n(1-z)}
$$&lt;/p>
&lt;p>研究一般的生成函数时，我们只关心各项系数而不关心生成函数在 $z$ 取特定值时的值，因而这种封闭形式的表达是没有问题的。但此时我们研究的是概率生成函数，我们需要知道 $z=1$ 时导数的值，而这种封闭形式的表达却要求 $z\neq 1$ 了。&lt;/p>
&lt;p>一种思路是运用洛必达法则求 $\lim\limits_{z\rightarrow 1}G_n^\prime(z)$ 和 $\lim\limits_{z\rightarrow 1}G_n^{\prime\prime}(z)$，进而求出 $X$ 的期望、方差。这种方法十分困难，在此不做展开。&lt;/p>
&lt;p>另一种思路是运用泰勒定理，得到&lt;/p>
&lt;p>$$
G_n(1+z) = \sum_{k\ge 0} \frac{G^{(k)}(1)}{k!}z^k
$$&lt;/p>
&lt;p>而由二项式定理&lt;/p>
&lt;p>$$
G_n(1+z) = \frac{(1+z)^n-1}{nz} = \sum_{k\ge 0} \frac{1}{n} \binom{n}{k} z^{k-1}
$$&lt;/p>
&lt;p>于是&lt;/p>
&lt;p>$$
\frac{G^{(k)}(1)}{k!} = \frac{1}{n} \binom{n}{k+1}
$$&lt;/p>
&lt;p>故&lt;/p>
&lt;p>$$
G_n^\prime(1)=\frac{n-1}{2}, G_n^{\prime\prime}(1)=\frac{(n-1)(n-2)}{3}
$$&lt;/p>
&lt;p>结合之前推导的关系，我们可以得出&lt;/p>
&lt;p>$$
E(X)=\frac{n-1}{2}, V(X)=\frac{n^2-1}{12}
$$&lt;/p>
&lt;p>类似地，我们也可以求泊松分布的期望、方差：&lt;/p>
&lt;p>$$
G_\lambda(z) = \sum_{k \ge 0}\frac{e^{-\lambda}\lambda^k}{k!}z^k = e^{\lambda(z-1)}
$$&lt;/p>
&lt;p>故&lt;/p>
&lt;p>$$
G_\lambda(1+z) = e^{\lambda z} = \sum \frac{\lambda^k}{k!}z^k
$$&lt;/p>
&lt;p>与泰勒展开式比较，可得 $G_\lambda^{(k)}=\lambda^k$，最终得到&lt;/p>
&lt;p>$$
E(X)=\lambda, V(X)=\lambda
$$&lt;/p>
&lt;p>然而，这种期望、方差的求法也不是万能的，将它用于二项分布就不是个好主意。&lt;/p>
&lt;h2 id="推导期望方差的可加性">推导期望、方差的可加性&lt;/h2>
&lt;p>设 $X$ 和 $Y$ 为两相互独立的随机变量，则&lt;/p>
&lt;p>$$
P(X = a \land Y = b) = P(X = a)P(Y = b)
$$&lt;/p>
&lt;p>那么&lt;/p>
&lt;p>$$
P(X + Y = n) = \sum_{a + b = n}P(X = a \land Y = b) = \sum_{a + b = n}P(X = a)P(Y = b)
$$&lt;/p>
&lt;p>这是一个卷积形式的式子，可以完美地用生成函数表示。即，若 $X$ 和 $Y$ 相互独立，我们就可以得到&lt;/p>
&lt;p>$$
G_{X+Y}(z) = G_X(z)G_Y(z)
$$&lt;/p>
&lt;p>这个式子是我们利用概率生成函数推导期望、方差可加性的基石。设随机变量 $X$、$Y$ 和 $X+Y$ 的概率生成函数分别为 $F(z)$、$G(z)$ 和 $H(z)$，根据我们推导出的关系 $H(z)=F(z)G(z)$，可以得到&lt;/p>
&lt;p>$$
\begin{aligned}
H^\prime(z) &amp;amp;= F^\prime(z)G(z) + F(z)G^\prime(z) \newline
H^{\prime\prime}(z) &amp;amp;= F^{\prime\prime}(z)G(z) + 2F^\prime(z)G^\prime(z) + F(z)G^{\prime\prime}(z)
\end{aligned}
$$&lt;/p>
&lt;p>由概率生成函数的定义可知 $F(1)=G(1)=H(1)=1$，那么&lt;/p>
&lt;p>$$
\begin{aligned}
H^\prime(1) &amp;amp;= F^\prime(1) + G^\prime(1) \newline
H^{\prime\prime}(1) &amp;amp;= F^{\prime\prime}(1) + 2F^\prime(1)G^\prime(1) + G^{\prime\prime}(1)
\end{aligned}
$$&lt;/p>
&lt;p>代入公式&lt;/p>
&lt;p>$$
\begin{aligned}
E(X) &amp;amp;= G_X^\prime(1) \newline
V(X) &amp;amp;= G_X^{\prime\prime}(1) + G_X^\prime(1) - \left(G_X^\prime(1)\right)^2
\end{aligned}
$$&lt;/p>
&lt;p>可得&lt;/p>
&lt;p>$$
\begin{aligned}
E(X+Y) &amp;amp;= E(X) + E(Y) \newline
V(X+Y) &amp;amp;= V(X) + V(Y)
\end{aligned}
$$&lt;/p>
&lt;p>即期望和方差都具有可加性。&lt;/p>
&lt;h2 id="二项分布和负二项分布">二项分布和负二项分布&lt;/h2>
&lt;p>二项分布我们都十分熟悉。由于它可以被看作 $n$ 个相互独立的伯努利试验的和，由可加性我们知它的期望和方差分别为 $np$ 和 $np(1-p)$。&lt;/p>
&lt;p>而负二项分布是指：进行若干次相互独立的伯努利试验，成功次数为 $n$ 次时失败次数的概率分布。假定单次伯努利试验的成功概率为 $p$，那么成功一次时失败次数 $X$ 的概率分布显然满足&lt;/p>
&lt;p>$$
P(X=k) = (1-p)^kp
$$&lt;/p>
&lt;p>那么我们可以写出 $X$ 的概率生成函数为&lt;/p>
&lt;p>$$
F(z) = \sum_{i \ge 0}(1-p)^ipz^i=\dfrac{p}{1-(1-p)z}
$$&lt;/p>
&lt;p>且其期望和方差分别为&lt;/p>
&lt;p>$$
E(X) = F^\prime(1) = \dfrac{(1-p)}{p}, V(X) = F^{\prime\prime}(1) + F^\prime(1) - \left(F^\prime(1)\right)^2 = \dfrac{(1-p)}{p^2}
$$&lt;/p>
&lt;p>负二项分布进行了重复了上述过程 $n$ 次，且每次相互独立，则我们也可知 $X \sim NB(n, p)$ 的概率分布函数就是 $F(z)$ 的 $n$ 次方，即：&lt;/p>
&lt;p>$$
G_n(z) = F^n(z) = \left(\dfrac{p}{1-(1-p)z}\right)^n=\sum\binom{n+i-1}{i}p^n(1-p)^iz^i
$$&lt;/p>
&lt;p>当然它的期望和方差也可得分别为 $\dfrac{n(1-p)}{p}$ 和 $\dfrac{n(1-p)}{p^2}$。&lt;/p>
&lt;p>负二项分布之名何来？我们发现，由于 $\dfrac{1}{F(1)} = 1$，$\dfrac{1}{F(z)}=\dfrac{1}{p}-\dfrac{1-p}{p}z$ 可被视做一次成功概率为 $-\dfrac{1-p}{p}$ （尽管它是个负数）的伯努利分布对应的概率分布函数，而 $G_n(z)=\left(\dfrac{1}{F(z)}\right)^{-n}$ 对应的就是 $-n$ （尽管这是个负数）次这样的伯努利试验的二项分布。&lt;/p>
&lt;p>未完待续&lt;/p></description></item></channel></rss>